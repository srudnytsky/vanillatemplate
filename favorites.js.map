{"version":3,"file":"favorites.js","sources":["../src/js/favorites.js"],"sourcesContent":["// favorites.js\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  // === MOBILE MENU ===\r\n  const menuToggle = document.querySelector('.menu-toggle');\r\n  const mobileMenu = document.querySelector('.mobile-menu');\r\n  const menuClose = document.querySelector('.mobile-menu-close');\r\n  \r\n  if (menuToggle && mobileMenu && menuClose) {\r\n    menuToggle.addEventListener('click', () => {\r\n      mobileMenu.classList.add('active');\r\n      document.body.style.overflow = 'hidden';\r\n    });\r\n    \r\n    menuClose.addEventListener('click', () => {\r\n      mobileMenu.classList.remove('active');\r\n      document.body.style.overflow = '';\r\n    });\r\n    \r\n    mobileMenu.querySelectorAll('.mobile-menu-link').forEach(link => {\r\n      link.addEventListener('click', () => {\r\n        mobileMenu.classList.remove('active');\r\n        document.body.style.overflow = '';\r\n      });\r\n    });\r\n  }\r\n\r\n  // === MAIN APP LOGIC ===\r\n  const API_BASE = 'https://your-energy.b.goit.study/api';\r\n\r\n  const favoritesContent = document.getElementById('favorites-content');\r\n  const quoteText = document.getElementById('fav-quote-text');\r\n  const quoteAuthor = document.getElementById('fav-quote-author');\r\n  const subscribeForm = document.getElementById('subscribe-form');\r\n\r\n  let currentExercise = null;\r\n\r\n  // === FAVORITES FUNCTIONS ===\r\n  function getFavorites() {\r\n    try {\r\n      return JSON.parse(localStorage.getItem('favorites')) || [];\r\n    } catch {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  function removeFromFavorites(exerciseId) {\r\n    const favorites = getFavorites();\r\n    const updatedFavorites = favorites.filter(fav => fav._id !== exerciseId);\r\n    localStorage.setItem('favorites', JSON.stringify(updatedFavorites));\r\n    displayFavorites(); // Перерисовываем список\r\n  }\r\n\r\n  // === ОТОБРАЖЕНИЕ ИЗБРАННОГО ===\r\n  function displayFavorites() {\r\n    const favorites = getFavorites();\r\n    \r\n    if (!favoritesContent) return;\r\n    \r\n    if (favorites.length === 0) {\r\n      favoritesContent.innerHTML = `\r\n        <div class=\"no-favorites\">\r\n          <p>You haven't added any exercises to favorites yet.</p>\r\n          <p>Go to the <a href=\"index.html\" style=\"color: #EEA10C;\">home page</a> to find exercises!</p>\r\n        </div>\r\n      `;\r\n      return;\r\n    }\r\n\r\n    favoritesContent.innerHTML = '';\r\n    \r\n    favorites.forEach(ex => {\r\n      const card = document.createElement('div');\r\n      card.className = 'exercise-card-horizontal';\r\n\r\n      const rating = ex.rating || 0;\r\n\r\n      card.innerHTML = `\r\n        <div class=\"exercise-card-left\">\r\n          <div class=\"workout-badge\">\r\n            WORKOUT ${rating.toFixed(1)} ⭐\r\n          </div>\r\n          <div class=\"exercise-info\">\r\n            <h3>${ex.name}</h3>\r\n            <div class=\"exercise-details\">\r\n              <span><span class=\"label\">Burned calories:</span> ${ex.burnedCalories || 0} / ${ex.time || 0} min</span>\r\n              <span><span class=\"label\">Body part:</span> ${ex.bodyPart || ''}</span>\r\n              <span><span class=\"label\">Target:</span> ${ex.target || ''}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <button class=\"remove-favorite-btn\" data-id=\"${ex._id}\">Remove</button>\r\n      `;\r\n\r\n      // Кнопка удаления\r\n      const removeBtn = card.querySelector('.remove-favorite-btn');\r\n      removeBtn.addEventListener('click', (e) => {\r\n        e.stopPropagation();\r\n        removeFromFavorites(ex._id);\r\n      });\r\n\r\n      // Открытие модального окна при клике на карточку\r\n      card.addEventListener('click', () => {\r\n        openExerciseModal(ex);\r\n      });\r\n\r\n      favoritesContent.appendChild(card);\r\n    });\r\n  }\r\n\r\n  // === Load daily quote ===\r\n  async function loadQuote() {\r\n    try {\r\n      const res = await fetch(`${API_BASE}/quote`);\r\n      if (!res.ok) throw new Error('Network error');\r\n      const data = await res.json();\r\n      if (data?.quote && data?.author) {\r\n        quoteText.textContent = data.quote;\r\n        quoteAuthor.textContent = data.author;\r\n      } else {\r\n        quoteText.textContent = \"Quote not available\";\r\n        quoteAuthor.textContent = \"\";\r\n      }\r\n    } catch (err) {\r\n      console.error('Error loading quote:', err);\r\n      quoteText.textContent = \"Failed to load quote\";\r\n    }\r\n  }\r\n\r\n  // === Open Exercise Modal ===\r\n  function openExerciseModal(exercise) {\r\n    const modal = document.getElementById('exercise-modal');\r\n    if (!modal) {\r\n      // Если модального окна нет на странице, создаем его\r\n      createModalAndOpen(exercise);\r\n      return;\r\n    }\r\n\r\n    currentExercise = exercise;\r\n\r\n    const modalImg = document.getElementById('modal-exercise-img');\r\n    const modalName = document.getElementById('modal-exercise-name');\r\n    const modalRating = document.getElementById('modal-rating-stars');\r\n    const modalTarget = document.getElementById('modal-target');\r\n    const modalBodyPart = document.getElementById('modal-body-part');\r\n    const modalEquipment = document.getElementById('modal-equipment');\r\n    const modalPopularity = document.getElementById('modal-popularity');\r\n    const modalCalories = document.getElementById('modal-calories');\r\n    const modalDescription = document.getElementById('modal-description-text');\r\n\r\n    if (modalImg) modalImg.src = exercise.gifUrl || 'https://via.placeholder.com/300x300?text=Exercise';\r\n    if (modalName) modalName.textContent = exercise.name || '';\r\n    \r\n    const rating = exercise.rating || 0;\r\n    const fullStars = Math.floor(rating);\r\n    const hasHalfStar = rating % 1 >= 0.5;\r\n    let starsDisplay = `${rating.toFixed(1)} `;\r\n    for (let i = 0; i < 5; i++) {\r\n      if (i < fullStars) {\r\n        starsDisplay += '⭐';\r\n      } else if (i === fullStars && hasHalfStar) {\r\n        starsDisplay += '⭐';\r\n      } else {\r\n        starsDisplay += '☆';\r\n      }\r\n    }\r\n    if (modalRating) modalRating.textContent = starsDisplay;\r\n    \r\n    if (modalTarget) modalTarget.textContent = exercise.target || '';\r\n    if (modalBodyPart) modalBodyPart.textContent = exercise.bodyPart || '';\r\n    if (modalEquipment) modalEquipment.textContent = exercise.equipment || '';\r\n    if (modalPopularity) modalPopularity.textContent = exercise.popularity || '0';\r\n    if (modalCalories) modalCalories.textContent = `${exercise.burnedCalories || 0}/${exercise.time || 0} min`;\r\n    if (modalDescription) modalDescription.textContent = exercise.description || 'No description available.';\r\n\r\n    // Обновляем кнопку избранного\r\n    const addFavoritesBtn = document.getElementById('modal-add-favorites');\r\n    if (addFavoritesBtn) {\r\n      const isFav = getFavorites().some(fav => fav._id === exercise._id);\r\n      if (isFav) {\r\n        addFavoritesBtn.innerHTML = 'Remove from favorites ♥';\r\n        addFavoritesBtn.style.color = '#EEA10C';\r\n        addFavoritesBtn.style.borderColor = '#EEA10C';\r\n      } else {\r\n        addFavoritesBtn.innerHTML = 'Add to favorites ♡';\r\n        addFavoritesBtn.style.color = '#F4F4F4';\r\n        addFavoritesBtn.style.borderColor = 'rgba(244, 244, 244, 0.2)';\r\n      }\r\n    }\r\n\r\n    modal.classList.add('active');\r\n    document.body.style.overflow = 'hidden';\r\n  }\r\n\r\n  // === Close Exercise Modal ===\r\n  function closeExerciseModal() {\r\n    const modal = document.getElementById('exercise-modal');\r\n    if (modal) {\r\n      modal.classList.remove('active');\r\n      document.body.style.overflow = '';\r\n    }\r\n  }\r\n\r\n  // === Modal event listeners ===\r\n  const modalCloseBtn = document.getElementById('modal-close');\r\n  const modalOverlay = document.querySelector('.modal-overlay');\r\n  \r\n  if (modalCloseBtn) {\r\n    modalCloseBtn.addEventListener('click', closeExerciseModal);\r\n  }\r\n  \r\n  if (modalOverlay) {\r\n    modalOverlay.addEventListener('click', (e) => {\r\n      if (e.target === modalOverlay) {\r\n        closeExerciseModal();\r\n      }\r\n    });\r\n  }\r\n\r\n  // Close modal on Escape key\r\n  document.addEventListener('keydown', (e) => {\r\n    if (e.key === 'Escape') {\r\n      closeExerciseModal();\r\n    }\r\n  });\r\n\r\n  // === Favorites button functionality in modal ===\r\n  const addFavoritesBtn = document.getElementById('modal-add-favorites');\r\n  if (addFavoritesBtn) {\r\n    addFavoritesBtn.addEventListener('click', () => {\r\n      if (!currentExercise) {\r\n        alert('No exercise selected');\r\n        return;\r\n      }\r\n\r\n      const favorites = getFavorites();\r\n      const exerciseId = currentExercise._id;\r\n      const favoriteIndex = favorites.findIndex(fav => fav._id === exerciseId);\r\n\r\n      if (favoriteIndex > -1) {\r\n        favorites.splice(favoriteIndex, 1);\r\n        localStorage.setItem('favorites', JSON.stringify(favorites));\r\n        addFavoritesBtn.innerHTML = 'Add to favorites ♡';\r\n        addFavoritesBtn.style.color = '#F4F4F4';\r\n        addFavoritesBtn.style.borderColor = 'rgba(244, 244, 244, 0.2)';\r\n        alert('Removed from favorites!');\r\n        displayFavorites(); // Обновляем список избранного\r\n      } else {\r\n        favorites.push(currentExercise);\r\n        localStorage.setItem('favorites', JSON.stringify(favorites));\r\n        addFavoritesBtn.innerHTML = 'Remove from favorites ♥';\r\n        addFavoritesBtn.style.color = '#EEA10C';\r\n        addFavoritesBtn.style.borderColor = '#EEA10C';\r\n        alert('Added to favorites!');\r\n        displayFavorites(); // Обновляем список избранного\r\n      }\r\n    });\r\n  }\r\n\r\n  // === Subscription ===\r\n  if (subscribeForm) {\r\n    subscribeForm.addEventListener('submit', async (e) => {\r\n      e.preventDefault();\r\n      const emailInput = subscribeForm.querySelector('input[type=\"email\"]');\r\n      const email = emailInput?.value.trim();\r\n\r\n      if (!email) {\r\n        alert('Please enter your email');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const res = await fetch(`${API_BASE}/subscription`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ email })\r\n        });\r\n\r\n        const data = await res.json();\r\n        alert(data.message || 'Successfully subscribed!');\r\n        subscribeForm.reset();\r\n      } catch (err) {\r\n        console.error('Subscription error:', err);\r\n        alert('Failed to subscribe. Please try again later.');\r\n      }\r\n    });\r\n  }\r\n\r\n  // === Initialization ===\r\n  loadQuote();\r\n  displayFavorites(); // Отображаем избранное при загрузке страницы\r\n});"],"names":["menuToggle","mobileMenu","menuClose","link","API_BASE","favoritesContent","quoteText","quoteAuthor","subscribeForm","currentExercise","getFavorites","removeFromFavorites","exerciseId","updatedFavorites","fav","displayFavorites","favorites","ex","card","rating","e","openExerciseModal","loadQuote","res","data","err","exercise","modal","modalImg","modalName","modalRating","modalTarget","modalBodyPart","modalEquipment","modalPopularity","modalCalories","modalDescription","fullStars","hasHalfStar","starsDisplay","i","addFavoritesBtn","closeExerciseModal","modalCloseBtn","modalOverlay","favoriteIndex","email"],"mappings":"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"}