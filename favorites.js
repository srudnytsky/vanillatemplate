import"./assets/base-Dpa1oMr_.js";document.addEventListener("DOMContentLoaded",()=>{const S=document.querySelector(".menu-toggle"),s=document.querySelector(".mobile-menu"),I=document.querySelector(".mobile-menu-close");S&&s&&I&&(S.addEventListener("click",()=>{s.classList.add("active"),document.body.style.overflow="hidden"}),I.addEventListener("click",()=>{s.classList.remove("active"),document.body.style.overflow=""}),s.querySelectorAll(".mobile-menu-link").forEach(e=>{e.addEventListener("click",()=>{s.classList.remove("active"),document.body.style.overflow=""})}));const C="https://your-energy.b.goit.study/api",c=document.getElementById("favorites-content"),y=document.getElementById("fav-quote-text"),B=document.getElementById("fav-quote-author"),d=document.getElementById("subscribe-form");let m=null;function u(){try{let e=localStorage.getItem("favorites");if(!e){const t=["favorites","fav","favouriteExercises","exerciseFavorites"];for(let o of t){const n=localStorage.getItem(o);if(n){console.log("Найдены избранные в ключе:",o),localStorage.setItem("favorites",n),e=n;break}}}if(!e)for(let t=0;t<localStorage.length;t++){const o=localStorage.key(t),n=localStorage.getItem(o);try{const a=JSON.parse(n);if(Array.isArray(a)&&a.length>0&&a[0]._id){console.log("Найден массив избранного в ключе:",o),localStorage.setItem("favorites",n),e=n;break}}catch{}}return e?JSON.parse(e):[]}catch(e){return console.error("Ошибка чтения избранного:",e),[]}}function p(e){try{localStorage.setItem("favorites",JSON.stringify(e)),console.log("Сохранено в localStorage:",e.length,"элементов")}catch(t){console.error("Ошибка сохранения:",t)}}function $(e){const o=u().filter(n=>n._id!==e);p(o),f()}function f(){const e=u();if(console.log("Отображаем избранное:",e.length,"элементов"),!!c){if(e.length===0){c.innerHTML=`
        <div class="no-favorites">
          <p>You haven't added any exercises to favorites yet.</p>
          <p>Go to the <a href="index.html" style="color: #EEA10C;">home page</a> to find exercises!</p>
        </div>
      `;return}c.innerHTML="",e.forEach(t=>{const o=document.createElement("div");o.className="exercise-card-horizontal";const n=t.rating||0;o.innerHTML=`
        <div class="exercise-card-left">
          <div class="workout-badge">
            WORKOUT ${n.toFixed(1)} ⭐
          </div>
          <div class="exercise-info">
            <h3>${t.name||"Unnamed exercise"}</h3>
            <div class="exercise-details">
              <span><span class="label">Burned calories:</span> ${t.burnedCalories||0} / ${t.time||0} min</span>
              <span><span class="label">Body part:</span> ${t.bodyPart||""}</span>
              <span><span class="label">Target:</span> ${t.target||""}</span>
            </div>
          </div>
        </div>
        <button class="remove-favorite-btn" data-id="${t._id}">Remove</button>
      `,o.querySelector(".remove-favorite-btn").addEventListener("click",v=>{v.stopPropagation(),$(t._id)}),o.addEventListener("click",()=>{M(t)}),c.appendChild(o)})}}async function T(){try{const e=await fetch(`${C}/quote`);if(!e.ok)throw new Error("Network error");const t=await e.json();t?.quote&&t?.author?(y.textContent=t.quote,B.textContent=t.author):(y.textContent="Quote not available",B.textContent="")}catch(e){console.error("Error loading quote:",e),y.textContent="Failed to load quote"}}function M(e){const t=document.getElementById("exercise-modal");if(!t){alert("Modal window not found");return}m=e;const o=document.getElementById("modal-exercise-img"),n=document.getElementById("modal-exercise-name"),a=document.getElementById("modal-rating-stars"),v=document.getElementById("modal-target"),x=document.getElementById("modal-body-part"),F=document.getElementById("modal-equipment"),k=document.getElementById("modal-popularity"),q=document.getElementById("modal-calories"),w=document.getElementById("modal-description-text");o&&(o.src=e.gifUrl||"https://via.placeholder.com/300x300?text=Exercise"),n&&(n.textContent=e.name||"");const h=e.rating||0,A=Math.floor(h),O=h%1>=.5;let g=`${h.toFixed(1)} `;for(let i=0;i<5;i++)i<A||i===A&&O?g+="⭐":g+="☆";a&&(a.textContent=g),v&&(v.textContent=e.target||""),x&&(x.textContent=e.bodyPart||""),F&&(F.textContent=e.equipment||""),k&&(k.textContent=e.popularity||"0"),q&&(q.textContent=`${e.burnedCalories||0}/${e.time||0} min`),w&&(w.textContent=e.description||"No description available.");const l=document.getElementById("modal-add-favorites");l&&(u().some(P=>P._id===e._id)?(l.innerHTML="Remove from favorites ♥",l.style.color="#EEA10C",l.style.borderColor="#EEA10C"):(l.innerHTML="Add to favorites ♡",l.style.color="#F4F4F4",l.style.borderColor="rgba(244, 244, 244, 0.2)")),t.classList.add("active"),document.body.style.overflow="hidden"}function E(){const e=document.getElementById("exercise-modal");e&&(e.classList.remove("active"),document.body.style.overflow="")}const L=document.getElementById("modal-close"),b=document.querySelector(".modal-overlay");L&&L.addEventListener("click",E),b&&b.addEventListener("click",e=>{e.target===b&&E()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&E()});const r=document.getElementById("modal-add-favorites");r&&r.addEventListener("click",()=>{if(!m){alert("No exercise selected");return}const e=u(),t=m._id,o=e.findIndex(n=>n._id===t);o>-1?(e.splice(o,1),p(e),r.innerHTML="Add to favorites ♡",r.style.color="#F4F4F4",r.style.borderColor="rgba(244, 244, 244, 0.2)",alert("Removed from favorites!"),f()):(e.push(m),p(e),r.innerHTML="Remove from favorites ♥",r.style.color="#EEA10C",r.style.borderColor="#EEA10C",alert("Added to favorites!"),f())}),d&&d.addEventListener("submit",async e=>{e.preventDefault();const o=d.querySelector('input[type="email"]')?.value.trim();if(!o){alert("Please enter your email");return}try{const a=await(await fetch(`${C}/subscription`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})})).json();alert(a.message||"Successfully subscribed!"),d.reset()}catch(n){console.error("Subscription error:",n),alert("Failed to subscribe. Please try again later.")}});function N(){console.log("=== localStorage diagnostic ==="),console.log("localStorage length:",localStorage.length);for(let e=0;e<localStorage.length;e++){const t=localStorage.key(e),o=localStorage.getItem(t);console.log(`Key: ${t}, Value length: ${o?.length}`);try{const n=JSON.parse(o);Array.isArray(n)&&console.log(`  → Это массив с ${n.length} элементами`)}catch{}}console.log("===============================")}N(),T(),f()});
//# sourceMappingURL=favorites.js.map
